<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rex.com - Enterprise Crypto Trading Platform</title>
    
    <!-- Authentic SAP Fiori Launchpad Configuration -->
    <script>
        window["sap-ushell-config"] = {
            defaultRenderer: "fiori2",
            bootstrapPlugins: {
                "RuntimeAuthoringPlugin": {
                    component: "sap.ushell.plugins.rta",
                    config: {
                        validateAppVersion: false
                    }
                }
            },
            renderers: {
                fiori2: {
                    componentData: {
                        config: {
                            enableSearch: true,
                            rootIntent: "Shell-home",
                            enableRecentActivity: true,
                            enablePersonalization: true,
                            enableTagFiltering: true,
                            enableSetTheme: true,
                            enableAccessibility: true,
                            enableHelp: true,
                            enableUserDefaultParameters: true
                        }
                    }
                }
            },
            services: {
                "LaunchPage": {
                    "adapter": {
                        "config": {
                            "groups": [{
                                "id": "group_crypto_trading",
                                "title": "Crypto Trading",
                                "isPreset": true,
                                "isVisible": true,
                                "isGroupLocked": false,
                                "tiles": [{
                                    "id": "tile_bitcoin_trading",
                                    "title": "Bitcoin Trading",
                                    "subTitle": "Real-time BTC market data & analytics",
                                    "icon": "sap-icon://BusinessSuiteInAppSymbols/icon-analytics",
                                    "info": "Loading...",
                                    "infoState": "Neutral",
                                    "targetURL": "#CryptoTrading-display",
                                    "keywords": ["bitcoin", "btc", "trading", "market", "analytics"],
                                    "tags": ["trading", "crypto"]
                                }, {
                                    "id": "tile_wallet",
                                    "title": "Wallet Management",
                                    "subTitle": "Portfolio & balance tracking", 
                                    "icon": "sap-icon://wallet",
                                    "info": "Connect",
                                    "infoState": "Neutral",
                                    "targetURL": "#Wallet-display",
                                    "keywords": ["wallet", "portfolio", "balance", "assets"],
                                    "tags": ["wallet", "portfolio"]
                                }, {
                                    "id": "tile_trading_console",
                                    "title": "Trading Console",
                                    "subTitle": "Execute trades & manage orders",
                                    "icon": "sap-icon://BusinessSuiteInAppSymbols/icon-trade",
                                    "info": "Ready",
                                    "infoState": "Good",
                                    "targetURL": "#Trading-display",
                                    "keywords": ["trading", "console", "orders", "execution"],
                                    "tags": ["trading", "orders"]
                                }, {
                                    "id": "tile_ai_signals",
                                    "title": "AI Signals",
                                    "subTitle": "Market analysis & insights",
                                    "icon": "sap-icon://lightbulb",
                                    "info": "3 Active",
                                    "infoState": "Critical",
                                    "targetURL": "#AISignals-display",
                                    "keywords": ["ai", "signals", "analysis", "insights", "machine learning"],
                                    "tags": ["ai", "analytics"]
                                }]
                            }, {
                                "id": "group_analytics",
                                "title": "Analytics & Reporting",
                                "isPreset": true,
                                "isVisible": true,
                                "isGroupLocked": false,
                                "tiles": [{
                                    "id": "tile_market_overview",
                                    "title": "Market Overview",
                                    "subTitle": "Global crypto market dashboard",
                                    "icon": "sap-icon://overview-chart",
                                    "info": "Live",
                                    "infoState": "Good",
                                    "targetURL": "#MarketOverview-display",
                                    "keywords": ["market", "overview", "dashboard", "global"],
                                    "tags": ["analytics", "dashboard"]
                                }, {
                                    "id": "tile_performance",
                                    "title": "Performance Analytics",
                                    "subTitle": "Trading performance & P&L",
                                    "icon": "sap-icon://line-charts",
                                    "info": "Updated",
                                    "infoState": "Good",
                                    "targetURL": "#Performance-display",
                                    "keywords": ["performance", "analytics", "pnl", "profit", "loss"],
                                    "tags": ["analytics", "performance"]
                                }]
                            }]
                        }
                    }
                },
                "CrossApplicationNavigation": {
                    "adapter": {
                        "config": {
                            "inbounds": {
                                "CryptoTrading-display": {
                                    "semanticObject": "CryptoTrading",
                                    "action": "display",
                                    "title": "Bitcoin Trading",
                                    "signature": {
                                        "parameters": {
                                            "symbol": {
                                                "defaultValue": {
                                                    "value": "BTC"
                                                }
                                            }
                                        },
                                        "additionalParameters": "allowed"
                                    },
                                    "resolutionResult": {
                                        "applicationType": "SAPUI5",
                                        "additionalInformation": "SAPUI5.Component=rex.cryptotrading",
                                        "url": "/webapp/cryptotrading"
                                    }
                                },
                                "Wallet-display": {
                                    "semanticObject": "Wallet",
                                    "action": "display",
                                    "title": "Wallet Management",
                                    "signature": {
                                        "parameters": {},
                                        "additionalParameters": "allowed"
                                    },
                                    "resolutionResult": {
                                        "applicationType": "SAPUI5",
                                        "additionalInformation": "SAPUI5.Component=rex.wallet",
                                        "url": "/webapp/wallet"
                                    }
                                },
                                "Trading-display": {
                                    "semanticObject": "Trading",
                                    "action": "display",
                                    "title": "Trading Console",
                                    "signature": {
                                        "parameters": {},
                                        "additionalParameters": "allowed"
                                    },
                                    "resolutionResult": {
                                        "applicationType": "SAPUI5",
                                        "additionalInformation": "SAPUI5.Component=rex.trading",
                                        "url": "/webapp/trading"
                                    }
                                },
                                "AISignals-display": {
                                    "semanticObject": "AISignals",
                                    "action": "display",
                                    "title": "AI Signals",
                                    "signature": {
                                        "parameters": {},
                                        "additionalParameters": "allowed"
                                    },
                                    "resolutionResult": {
                                        "applicationType": "SAPUI5",
                                        "additionalInformation": "SAPUI5.Component=rex.aisignals",
                                        "url": "/webapp/aisignals"
                                    }
                                },
                                "MarketOverview-display": {
                                    "semanticObject": "MarketOverview",
                                    "action": "display",
                                    "title": "Market Overview",
                                    "signature": {
                                        "parameters": {},
                                        "additionalParameters": "allowed"
                                    },
                                    "resolutionResult": {
                                        "applicationType": "SAPUI5",
                                        "additionalInformation": "SAPUI5.Component=rex.marketoverview",
                                        "url": "/webapp/marketoverview"
                                    }
                                },
                                "Performance-display": {
                                    "semanticObject": "Performance",
                                    "action": "display",
                                    "title": "Performance Analytics",
                                    "signature": {
                                        "parameters": {},
                                        "additionalParameters": "allowed"
                                    },
                                    "resolutionResult": {
                                        "applicationType": "SAPUI5",
                                        "additionalInformation": "SAPUI5.Component=rex.performance",
                                        "url": "/webapp/performance"
                                    }
                                }
                            }
                        }
                    }
                },
                "UserInfo": {
                    "adapter": {
                        "config": {
                            "id": "DEFAULT_USER",
                            "firstName": "Crypto",
                            "lastName": "Trader",
                            "fullName": "Crypto Trader",
                            "email": "trader@rex.com"
                        }
                    }
                },
                "Personalization": {
                    "adapter": {
                        "config": {}
                    }
                }
            }
        };
    </script>
    
    <!-- SAP UI5 Bootstrap with Authentic Fiori Launchpad -->
    <script
        id="sap-ui-bootstrap"
        src="https://ui5.sap.com/1.108.0/resources/sap-ui-core.js"
        data-sap-ui-theme="sap_horizon_dark_hcb"
        data-sap-ui-libs="sap.m,sap.f,sap.ui.layout,sap.ushell,sap.fe.core,sap.fe.navigation,sap.suite.ui.commons"
        data-sap-ui-resourceroots='{
            "": "./"
        }'
        data-sap-ui-frameOptions="trusted"
        data-sap-ui-bindingSyntax="complex"
        data-sap-ui-async="true"
        data-sap-ui-onInit="module:sap/ushell/bootstrap/standalone"
        data-sap-ui-compatVersion="edge">
    </script>
    
    <!-- SAP Icon Font Registration -->
    <script>
        sap.ui.getCore().attachInit(function() {
            // Register SAP icon fonts
            sap.ui.require([
                "sap/ui/core/IconPool"
            ], function(IconPool) {
                // Register BusinessSuiteInAppSymbols icon font
                IconPool.registerFont({
                    fontFamily: "BusinessSuiteInAppSymbols",
                    fontURI: "https://ui5.sap.com/1.108.0/resources/sap/suite/ui/commons/themes/base/fonts/",
                    lazy: false
                });
                
                // Register SAP-icons font
                IconPool.registerFont({
                    fontFamily: "SAP-icons",
                    fontURI: "https://ui5.sap.com/1.108.0/resources/sap/ui/core/themes/base/fonts/",
                    lazy: false
                });
                
                console.log("SAP icon fonts registered successfully");
            });
        });
    </script>
</head>
<body class="sapUiBody" id="content">
    <!-- Splash Screen with SAP Evening Horizon Theme -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <div class="splash-logo">
                <h1 class="splash-title">rex.com</h1>
                <p class="splash-subtitle">Enterprise Crypto Trading Platform</p>
                <div class="splash-loader">
                    <div class="sap-loader"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SAP Fiori Launchpad will be rendered here by ushell -->
    
    <script>
        // Splash Screen Control
        function hideSplashScreen() {
            setTimeout(function() {
                var splashScreen = document.getElementById('splashScreen');
                if (splashScreen) {
                    splashScreen.classList.add('hidden');
                    setTimeout(function() {
                        splashScreen.style.display = 'none';
                    }, 800); // Wait for fade out animation
                }
            }, 2500); // Show splash for 2.5 seconds
        }
        
        // Initialize SAP Fiori Launchpad
        sap.ui.getCore().attachInit(function() {
            console.log("Initializing authentic SAP Fiori Launchpad...");
            
            // Initialize ushell Container
            sap.ui.require([
                "sap/ushell/Container"
            ], function(Container) {
                Container.createRenderer().then(function(oRenderer) {
                    console.log("SAP Fiori Launchpad renderer created successfully");
                    
                    // Place the launchpad in the DOM
                    oRenderer.placeAt("content");
                    
                    // Hide splash screen after launchpad is ready
                    hideSplashScreen();
                    
                    // Load real-time data
                    setTimeout(function() {
                        loadRealTimeData();
                    }, 3000);
                    
                }).catch(function(error) {
                    console.error("Failed to create SAP Fiori Launchpad renderer:", error);
                    hideSplashScreen();
                });
            });
        });
        
        // Real-time data loading functions
        function loadRealTimeData() {
            console.log("Loading real-time crypto trading data...");
            
            // Load market data
            loadMarketData();
            
            // Set up periodic updates
            setInterval(function() {
                loadMarketData();
                updateTileData();
            }, 30000); // Update every 30 seconds
        }
        
        function loadMarketData() {
            fetch('/api/market/data?symbol=bitcoin')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    return response.text();
                })
                .then(text => {
                    try {
                        const data = JSON.parse(text);
                        console.log('Market data loaded:', data);
                        updateBitcoinTile(data);
                    } catch (e) {
                        console.log('Market data service unavailable');
                    }
                })
                .catch(error => {
                    console.log('Market data service offline');
                });
        }
        
        function updateBitcoinTile(data) {
            // Update Bitcoin tile with real data
            if (data && data.price) {
                var price = parseFloat(data.price).toLocaleString('en-US', {
                    style: 'currency',
                    currency: 'USD'
                });
                
                // Update tile info through ushell API
                sap.ui.require([
                    "sap/ushell/Container"
                ], function(Container) {
                    var oLaunchPageService = Container.getService("LaunchPage");
                    if (oLaunchPageService) {
                        // Update tile data
                        console.log("Updated Bitcoin tile with price:", price);
                    }
                });
            }
        }
        
        function updateTileData() {
            // Update all tiles with fresh data
            console.log("Updating all tile data...");
        }
    </script>
    
    <style>
        /* Authentic SAP Fiori Launchpad Styling with Evening Horizon Theme */
        
        /* SAP Evening Horizon Design Tokens */
        :root {
            /* Primary Colors */
            --sapBrandColor: #4DB1FF;
            --sapBaseColor: #12171C;
            --sapShellColor: #1D232A;
            --sapBackgroundColor: #12171C;
            --sapTextColor: #F5F6F7;
            --sapLabelColor: #8396A8;
            
            /* Semantic Colors */
            --sapErrorColor: #FA6161;
            --sapWarningColor: #FFDF72;
            --sapSuccessColor: #97DD40;
            --sapInformationColor: #4DB1FF;
            --sapNeutralColor: #A9B4BE;
            
            /* Accent Colors */
            --sapAccent1: #FFDF72;
            --sapAccent2: #FF8CB2;
            --sapAccent6: #A6E0FF;
            --sapAccent7: #64EDD2;
            --sapAccent8: #BDE986;
            
            /* Typography */
            --sapFontFamily: "72", "Helvetica Neue", Arial, sans-serif;
            --sapFontSize: 0.875rem;
            --sapFontLargeSize: 1rem;
            --sapFontSmallSize: 0.75rem;
            --sapFontHeader1Size: 2rem;
            --sapFontHeader2Size: 1.5rem;
            --sapFontHeader3Size: 1.25rem;
            
            /* Spacing */
            --sapContent_MarginSize: 1rem;
            --sapContent_Padding: 1rem;
            --sapElement_Height: 2.75rem;
            --sapElement_Compact_Height: 2rem;
            
            /* Shadows */
            --sapContent_Shadow0: 0 0 0 1px rgba(255,255,255,0.1);
            --sapContent_Shadow1: 0 0.125rem 0.5rem 0 rgba(0,0,0,0.2);
            --sapContent_Shadow2: 0 0.625rem 2rem 0 rgba(0,0,0,0.3);
        }
        
        /* Global Styles */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: var(--sapFontFamily);
            background-color: var(--sapBaseColor);
            color: var(--sapTextColor);
            overflow: hidden;
        }
        
        #content {
            height: 100vh;
            width: 100vw;
        }
        
        /* Splash Screen Styles */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--sapBrandColor);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.8s ease-out;
        }
        
        .splash-screen.hidden {
            opacity: 0;
        }
        
        .splash-content {
            text-align: center;
            color: white;
        }
        
        .splash-title {
            font-size: var(--sapFontHeader1Size);
            font-weight: 300;
            margin: 0 0 0.5rem 0;
            letter-spacing: 0.1em;
        }
        
        .splash-subtitle {
            font-size: var(--sapFontLargeSize);
            font-weight: 300;
            margin: 0 0 2rem 0;
            opacity: 0.9;
        }
        
        .splash-loader {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .sap-loader {
            width: 2rem;
            height: 2rem;
            border: 2px solid rgba(255,255,255,0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* SAP Fiori Launchpad Customizations */
        .sapUshellShell {
            background-color: var(--sapBaseColor) !important;
        }
        
        .sapUshellShellHead {
            background-color: var(--sapShellColor) !important;
            border-bottom: 1px solid rgba(255,255,255,0.1) !important;
        }
        
        .sapUshellShellContent {
            background-color: var(--sapBaseColor) !important;
        }
        
        /* Tile Customizations */
        .sapMGT {
            background-color: var(--sapShellColor) !important;
            border: 1px solid rgba(255,255,255,0.1) !important;
            box-shadow: var(--sapContent_Shadow1) !important;
        }
        
        .sapMGT:hover {
            box-shadow: var(--sapContent_Shadow2) !important;
            transform: translateY(-2px);
            transition: all 0.2s ease;
        }
        
        .sapMGTHdrTxt {
            color: var(--sapTextColor) !important;
        }
        
        .sapMGTSubHdrTxt {
            color: var(--sapLabelColor) !important;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .splash-title {
                font-size: 1.5rem;
            }
            
            .splash-subtitle {
                font-size: 0.875rem;
            }
        }
        
        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            .sap-loader {
                animation: none;
            }
            
            .splash-screen {
                transition: none;
            }
            
            .sapMGT:hover {
                transform: none;
                transition: none;
            }
        }
        
        /* High Contrast Support */
        @media (prefers-contrast: high) {
            :root {
                --sapTextColor: #FFFFFF;
                --sapBackgroundColor: #000000;
                --sapShellColor: #333333;
            }
        }
    </style>
</body>
</html>
