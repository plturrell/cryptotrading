<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>rex.com - Professional Crypto Trading Platform</title>
    
    <!-- SAP UI5 Bootstrap -->
    <script id="sap-ui-bootstrap"
            src="https://ui5.sap.com/1.120.0/resources/sap-ui-core.js"
            data-sap-ui-theme="sap_horizon_dark"
            data-sap-ui-libs="sap.m,sap.ui.layout,sap.f"
            data-sap-ui-compatVersion="edge"
            data-sap-ui-frameOptions="allow"
            data-sap-ui-preload="async"
            data-sap-ui-xx-waitForTheme="true"
            data-sap-ui-resourceroots='{
                "com.rex.cryptotrading": "./"
            }'>
    </script>
    
    <script>
        sap.ui.getCore().attachInit(function() {
            sap.ui.require([
                "sap/m/Shell",
                "sap/m/App", 
                "sap/m/Page",
                "sap/m/TileContainer",
                "sap/m/StandardTile",
                "sap/ui/model/json/JSONModel"
            ], function(Shell, App, Page, TileContainer, StandardTile, JSONModel) {
                
                // Create data model
                var oModel = new JSONModel({
                    services: {
                        marketPairs: "Loading...",
                        agents: "Loading...",
                        insights: "12 Insights",
                        projects: "8 Projects", 
                        jobs: "24 Jobs",
                        metrics: "156 Metrics",
                        users: "42 Users",
                        totalServices: "8 Services"
                    }
                });
                
                // Create tiles
                var oMarketTile = new StandardTile({
                    icon: "sap-icon://line-chart",
                    title: "Market Analysis Service",
                    info: "{/services/marketPairs}",
                    press: function() {
                        window.open('/$fiori-preview/MarketAnalysisService/MarketPairs#preview-app', '_blank');
                    }
                });
                
                var oA2ATile = new StandardTile({
                    icon: "sap-icon://connected", 
                    title: "A2A Agent Service",
                    info: "{/services/agents}",
                    press: function() {
                        window.open('/$fiori-preview/com.rex.cryptotrading.a2a.service.A2AService/A2AAgents#preview-app', '_blank');
                    }
                });
                
                var oIntelligenceTile = new StandardTile({
                    icon: "sap-icon://brain",
                    title: "Intelligence Service", 
                    info: "{/services/insights}",
                    press: function() {
                        window.open('/$fiori-preview/com.rex.cryptotrading.intelligence.service.IntelligenceService/AIInsights#preview-app', '_blank');
                    }
                });
                
                var oCodeTile = new StandardTile({
                    icon: "sap-icon://source-code",
                    title: "Code Analysis Service",
                    info: "{/services/projects}",
                    press: function() {
                        window.open('/$fiori-preview/com.rex.cryptotrading.codeanalysis.service.CodeAnalysisService/Projects#preview-app', '_blank');
                    }
                });
                
                var oDataPipelineTile = new StandardTile({
                    icon: "sap-icon://pipeline-analysis",
                    title: "Data Pipeline Service",
                    info: "{/services/jobs}",
                    press: function() {
                        window.open('/$fiori-preview/com.rex.cryptotrading.datapipeline.service.DataPipelineService/DataIngestionJobs#preview-app', '_blank');
                    }
                });
                
                var oMonitoringTile = new StandardTile({
                    icon: "sap-icon://monitoring-system",
                    title: "Monitoring Service",
                    info: "{/services/metrics}",
                    press: function() {
                        window.open('/$fiori-preview/com.rex.cryptotrading.monitoring.service.MonitoringService/SystemHealth#preview-app', '_blank');
                    }
                });
                
                var oUserTile = new StandardTile({
                    icon: "sap-icon://person-placeholder",
                    title: "User Service",
                    info: "{/services/users}",
                    press: function() {
                        window.open('/$fiori-preview/com.rex.cryptotrading.user.service.UserService/Users#preview-app', '_blank');
                    }
                });
                
                var oOverviewTile = new StandardTile({
                    icon: "sap-icon://overview-chart",
                    title: "Services Overview",
                    info: "{/services/totalServices}",
                    press: function() {
                        window.open('/', '_blank');
                    }
                });
                
                // Create tile container
                var oTileContainer = new TileContainer({
                    tiles: [oMarketTile, oA2ATile, oIntelligenceTile, oCodeTile, oDataPipelineTile, oMonitoringTile, oUserTile, oOverviewTile]
                });
                
                // Create page
                var oPage = new Page({
                    title: "rex.com - Crypto Trading Platform",
                    content: [oTileContainer]
                });
                
                // Create app
                var oApp = new App({
                    pages: [oPage]
                });
                
                // Create shell
                var oShell = new Shell({
                    app: oApp,
                    headerRightText: "Professional Trading"
                });
                
                // Set model and place shell
                oShell.setModel(oModel);
                oShell.placeAt("content");
                
                // Load real data
                loadServiceData(oModel);
            });
        });
        
        // Data loading function
        function loadServiceData(oModel) {
            // Load market data
            fetch('http://localhost:4004/odata/v4/market-analysis/MarketPairs?$count=true')
                .then(response => response.json())
                .then(data => {
                    oModel.setProperty('/services/marketPairs', data['@odata.count'] + ' Pairs');
                })
                .catch(() => {
                    oModel.setProperty('/services/marketPairs', 'Service Offline');
                });
            
            // Load A2A agents data
            fetch('http://localhost:4004/odata/v4/a2a/A2AAgents?$count=true')
                .then(response => response.json())
                .then(data => {
                    oModel.setProperty('/services/agents', data['@odata.count'] + ' Agents');
                })
                .catch(() => {
                    oModel.setProperty('/services/agents', 'Service Offline');
                });
        }
    </script>
</head>
<body class="sapUiBody" id="content">
</body>
</html>